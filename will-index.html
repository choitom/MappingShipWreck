<://ships.richardsw.com/images/coins.png' },
     dolia: { label: 'http://ships.richardsw.com/images/dolia.png' },
     glass: { label: 'http://ships.richardsw.com/images/glass.png' },
     grain: { label: 'http://ships.richardsw.com/images/grain.png' },
     lamps: { label: 'http://ships.richardsw.com/images/lamp.png' },
     marble: { label: 'http://ships.richardsw.com/images/stone.png' },
     masonry: { label: 'http://ships.richardsw.com/images/stone.png' },
     metal: { label: 'http://ships.richardsw.com/images/metal.png' },
     stone: { label: 'http://ships.richardsw.com/images/stone.png' },
     tiles: { label: 'http://ships.richardsw.com/images/tiles.png' },
     'nothing reported': { label: 'http://ships.richardsw.com/images/unknown.png' }

     };

      function initMap() {
       var map = new google.maps.Map(document.getElementById('map'), {
         center: new google.maps.LatLng(43.1, 12.2),
         zoom: 6
        });
       var infoWindow = new google.maps.InfoWindow;


       downloadUrl('http://ships.richardsw.com/ships.php', function(data) {

           var xml = data.responseXML;
           var markers = xml.documentElement.getElementsByTagName('ship');


									   var markerArray = [];
           Array.prototype.forEach.call(markers, function(markerElem) {

             var name = markerElem.getAttribute('Name');
             var comments = markerElem.getAttribute('Comments');
             var c1_Type = markerElem.getAttribute('c1_Type');
             var c2_Type = markerElem.getAttribute('c2_Type');
             var c3_Type = markerElem.getAttribute('c3_Type');
             var point = new google.maps.LatLng(
                 parseFloat(markerElem.getAttribute('Lattitude')),
                 parseFloat(markerElem.getAttribute('Longitude')));


             var infowincontent = document.createElement('div');
             var strong = document.createElement('strong');
             strong.textContent = name;
             infowincontent.appendChild(strong);
             infowincontent.appendChild(document.createElement('br'));

             
             var text = document.createElement('text');
             text.textContent =  comments;
             infowincontent.appendChild(text);

             var icon = customLabel[c1_Type] || {};

             var marker = new google.maps.Marker({
               map: map,
               position: point,
               icon: {
               url: icon.label,
               scaledSize: new google.maps.Size(50,50)
               }
             });
             markerArray.push(marker);
             marker.addListener('click', function() {
               infoWindow.setContent(infowincontent);
               infoWindow.open(map, marker);
               });
               
	            });
		         var markerCluster = new MarkerClusterer(map, markerArray,
            {imagePath: 'https://ships.richardsw.com/images/cluster/m'});
								       });
								        

      }



     function downloadUrl(url, callback) {
       var request = window.ActiveXObject ?
           new ActiveXObject('Microsoft.XMLHTTP') :
           new XMLHttpRequest;

       request.onreadystatechange = function() {
         if (request.readyState == 4) {
           request.onreadystatechange = doNothing;
           callback(request, request.status);
         }
       };

       request.open('GET', url, true);
       request.send(null);
     }

 
     function search(){
     var input = document.getElementById('pac-input');
        var searchBox = new google.maps.places.SearchBox(input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        map.addListener('bounds_changed', function() {
          searchBox.setBounds(map.getBounds());
        }); 
        
        var markers = [];}

     function doNothing() {}
     



         

    </script>
    
    
    <script src="http://ships.richardsw.com/markerclusterer.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChQM2QAwvMQoUbdVCA9ENlAUF0GXWfRf8&libraries=places"></script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChQM2QAwvMQoUbdVCA9ENlAUF0GXWfRf8&callback=initMap">
    </script>
    </body>
